<!-- 管理员列表 -->

<!-- Content Header -->
<section class="content-header">
	<h1>
    	部门管理
    </h1>
	<ol class="breadcrumb">
		<li><a href="index.html"><i class="fa fa-dashboard"></i> 首页</a></li>
		<li><a href="#">系统管理</a></li>
		<li class="active">部门管理</li>
	</ol>
</section>
<!-- /Content Header -->

<!-- Main content -->
<section class="content">
	<div class="box">
		<div class="box-header">
			<h3 class="box-title">部门列表</h3>
			<div class="box-tools">
				<span class="pull-left span-lh">部门名称</span>
				<div class="input-group pull-left">
					<input type="text" class="form-control input-sm" placeholder="部门名称" />
				</div>
				<span class="pull-left span-lh">部门代码</span>
				<div class="input-group pull-left">
					<input type="text" class="form-control input-sm" placeholder="部门代码" />
				</div>
				<span class="pull-left span-lh">上级部门</span>
				<div class="input-group pull-left out-select">
					<select class="higher-level">
						<option value=""></option>
						<option value="部门A">部门A</option>
						<option value="部门B">部门B</option>
						<option value="部门C">部门C</option>
						<option value="部门C">部门C</option>
						<option value="部门C">部门C</option>
						<option value="部门C">部门C</option>
						<option value="部门C">部门C</option>
						<option value="部门C">部门C</option>
					</select>
				</div>
				<div class="pull-right">
					<a href="#" class="btn btn-default btn-sm">
						<i class="fa fa-search"></i> 检索
					</a>
					<a href="#" class="btn btn-default btn-sm" data-toggle="modal" data-target="#adminModal">
						<i class="fa fa-plus-circle"></i> 新增
					</a>
				</div>
			</div>
		</div>
		<div class="box-body no-padding">
			<table class="table table-striped">
				<tbody>
					<tr>
						<th>部门代码</th>
						<th>部门名称</th>
						<th>上级部门</th>
						<th>部门电话</th>
						<th>创建时间</th>
						<th>操作</th>
					</tr>
					<tr>
						<td>001</td>
						<td>子部门A</td>
						<td>部门A</td>
						<td>13625272637</td>
						<td>2016-02-21</td>
						<td>
							<a href="#" title="编辑" data-toggle="modal" data-target="#adminModal"><i class="fa fa-edit"></i></a>
							<a href="#" title="删除" data-toggle="modal" data-target="#deleteModal"><i class="fa fa-remove"></i></a>
						</td>
					</tr>
					<tr>
						<td>002</td>
						<td>子部门A</td>
						<td>部门A</td>
						<td>13625272637</td>
						<td>2016-02-21</td>
						<td>
							<a href="#" title="编辑" data-toggle="modal" data-target="#adminModal"><i class="fa fa-edit"></i></a>
							<a href="#" title="删除" data-toggle="modal" data-target="#deleteModal"><i class="fa fa-remove"></i></a>
						</td>
					</tr>
					<tr>
						<td>003</td>
						<td>子部门A</td>
						<td>部门A</td>
						<td>13625272637</td>
						<td>2016-02-21</td>
						<td>
							<a href="#" title="编辑" data-toggle="modal" data-target="#adminModal"><i class="fa fa-edit"></i></a>
							<a href="#" title="删除" data-toggle="modal" data-target="#deleteModal"><i class="fa fa-remove"></i></a>
						</td>
					</tr>
					<tr>
						<td>004</td>
						<td>子部门A</td>
						<td>部门A</td>
						<td>13625272637</td>
						<td>2016-02-21</td>
						<td>
							<a href="#" title="编辑" data-toggle="modal" data-target="#adminModal"><i class="fa fa-edit"></i></a>
							<a href="#" title="删除" data-toggle="modal" data-target="#deleteModal"><i class="fa fa-remove"></i></a>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<div class="box-footer clearfix">
			<p class="pull-left">
				共<span>52</span>条记录， 共
				<span>6</span>页
			</p>
			<ul class="pagination pagination-sm no-margin pull-right">
				<li><a href="#">«</a></li>
				<li><a href="#">1</a></li>
				<li><a href="#">2</a></li>
				<li><a href="#">3</a></li>
				<li><a href="#">»</a></li>
			</ul>
		</div>
	</div>
</section>
<!-- Main content -->

<!-- Modals -->
<div class="modal fade" id="adminModal">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
				<h4 class="modal-title">部门管理-新增/编辑</h4>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="col-md-6">
						<div class="form-group">
							<label>部门代码</label>
							<input type="text" class="form-control" />
						</div>
					</div>
					<div class="col-md-6">
						<div class="form-group">
							<label>部门名称</label>
							<input type="text" class="form-control" />
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<div class="form-group">
							<label>部门电话</label>
							<input type="text" class="form-control" />
						</div>
					</div>
					<div class="col-md-6">
						<div class="form-group">
							<label>部门传真</label>
							<input type="text" class="form-control" />
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<div class="form-group">
							<label>邮政编码</label>
							<input type="text" class="form-control" />
						</div>
					</div>
					<div class="col-md-6">
						<div class="form-group">
							<label>部门背景</label>
							<input type="text" class="form-control" />
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<div class="form-group modal-select">
							<label>上级部门</label>
            				<select class="higher-level1">
								<option value=""></option>
								<option value="部门A">部门A</option>
								<option value="部门A">部门A</option>
								<option value="部门A">部门A</option>
								<option value="部门A">部门A</option>
								<option value="部门A">部门A</option>
								<option value="部门A">部门A</option>
								<option value="部门A">部门A</option>
								<option value="部门A">部门A</option>
								<option value="部门A">部门A</option>
								
							</select>
						</div>
					</div>
					<div class="col-md-6">
						<div class="form-group" style="position: relative;">
							<label>业务分类</label>
							<input type="text" class="form-control" readonly="readonly" id="selInput1" placeholder="选择业务" />
							<!-- 树形下拉选择框 -->
							<div class="ztree-sel" id="selDiv1" style="left:0px;top:60px;">
								<ul class="ztree" id="selTree1"></ul>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12">
						<div class="form-group">
							<label>部门描述</label>
							<textarea class="form-control" rows="2" placeholder="请输入100字以内 ..."></textarea>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default pull-left" data-dismiss="modal">取消</button>
				<button type="button" class="btn btn-preserve">保存</button>
			</div>
		</div>

	</div>
</div>

<div class="modal fade" id="roleModal">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
				<h4 class="modal-title">分配角色</h4>
			</div>
			<div class="modal-body">
				<ul class="ztree" id="roleTree"></ul>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default pull-left" data-dismiss="modal">取消</button>
				<button type="button" class="btn btn-preserve" id="saveBtn">保存</button>
			</div>
		</div>
	</div>
</div>
<div class="modal fade" id="deleteModal">
	 <div class="modal-dialog prompt">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
            	<h4 class="modal-title">&nbsp;</h4>
            </div>
            <div class="modal-body">
                <p class="delete-sure">确认删除该项？</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-preserve">确认</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<!-- /Modals -->

<script type="text/javascript">
	$(function() {
		//选择日期
		$(".dpicker").datepicker({
			format: 'yyyy-mm-dd',
			language: 'zh-CN',
			todayHighlight: true
		});
		//获取选中的节点Id
		$("#saveBtn").on("click", function(e) {
			e.preventDefault();
			var zTreeObj = $.fn.zTree.getZTreeObj("roleTree");
			var selectedNodes = zTreeObj.getCheckedNodes(true);
			var selectedIds = [];
			$.each(selectedNodes, function(i, el) {
				selectedIds.push(el.id);
			});
			//console.log("Selected: ", selectedIds);
		});
		
		//初始化下拉树形结构1
//		var selNodes = [
//			{id:1, pId:0, name:"部门1", open:true, nocheck:true},
//			{id:11, pId:1, name:"子部门1"},
//			{id:12, pId:1, name:"子部门2"},
//			{id:13, pId:1, name:"子部门2"},
//			{id:14, pId:1, name:"子部门2"},
//			{id:15, pId:1, name:"子部门2"},
//			{id:16, pId:1, name:"子部门2"}
//			
//		];
//		$.fn.zTree.init($("#selTree"), {
//			data: {
//				simpleData: {enable:true, idKey:"id", pIdKey:"pId", rootPId:0}
//			},
//			check: {enable:true, chkboxType:{"Y":"", "N":""}},
//			view: {showIcon:false, dblClickExpand:false},
//			callback: {
//				onCheck: function(e, treeId, treeNode) {
//					var zTree = $.fn.zTree.getZTreeObj("selTree"),
//					nodes = zTree.getCheckedNodes(true),
//					v = "";
//					for(var i=0, l=nodes.length; i<l; i++) {
//						v += nodes[i].name + ",";
//					}
//					if(v.length > 0) {
//						v = v.substring(0, v.length-1);
//					};
//					$("#selInput").val(v);
//				}
//			}
//		}, selNodes);
		//弹出树形下拉选择框
//		$("#selInput").on("click", function(e) {
//			e.stopPropagation();
//			$("#selDiv").slideDown();
//			$("#selDiv1").slideUp();
//		});
		//隐藏树形下拉选择框
		$("body").on("click", function() {
//			$("#selDiv").slideUp();
			$("#selDiv1").slideUp();
		});
//		$("#selDiv").on("click", function(e) {
//			e.stopPropagation();
//		});
		//初始化下拉树形结构2
		var selNodes1 = [
			{id:1, pId:0, name:"业务1", open:true, nocheck:true},
			{id:11, pId:1, name:"子业务1"},
			{id:12, pId:1, name:"子业务2"},
			{id:13, pId:1, name:"子业务2"},
			{id:14, pId:1, name:"子业务2"},
			{id:15, pId:1, name:"子业务2"},
			{id:16, pId:1, name:"子业务2"}
			
		];
		$.fn.zTree.init($("#selTree1"), {
			data: {
				simpleData: {enable:true, idKey:"id", pIdKey:"pId", rootPId:0}
			},
			check: {enable:true, chkboxType:{"Y":"", "N":""}},
			view: {showIcon:false, dblClickExpand:false},
			callback: {
				onCheck: function(e, treeId, treeNode) {
					var zTree = $.fn.zTree.getZTreeObj("selTree1"),
					nodes = zTree.getCheckedNodes(true),
					v = "";
					for(var i=0, l=nodes.length; i<l; i++) {
						v += nodes[i].name + ",";
					}
					if(v.length > 0) {
						v = v.substring(0, v.length-1);
					};
					$("#selInput1").val(v);
				}
			}
		}, selNodes1);
		//弹出树形下拉选择框
		$("#selInput1").on("click", function(e) {
			e.stopPropagation();
			$("#selDiv1").slideDown();
//			$("#selDiv").slideUp();
		});
		//隐藏树形下拉选择框
		$("#selDiv1").on("click", function(e) {
			e.stopPropagation();
		});		
		
//		内容互换
		$('#undo_redo').multiselect();
//		模糊查询
		$(".higher-level,.higher-level1").select2({
			 placeholder: "选择上级部门",
 			 allowClear: true,
 			 width:"100%"
		});
	});
</script>